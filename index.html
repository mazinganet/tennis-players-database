<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéæ Database Giocatori Tennis</title>
    <meta name="description"
        content="Gestione database giocatori di tennis con disponibilit√† oraria e filtri di ricerca">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Login Overlay -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-box">
            <div class="login-header">
                <span class="login-icon">üéæ</span>
                <h2>Area Riservata</h2>
            </div>
            <form id="loginForm">
                <div class="login-field">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Inserisci la password..." required autofocus>
                </div>
                <div class="login-error" id="loginError"></div>
                <button type="submit" class="btn btn-primary btn-login">
                    üîì Accedi
                </button>
            </form>
        </div>
    </div>

    <style>
        .login-overlay {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-700) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: var(--space-lg);
        }

        .login-overlay.hidden {
            display: none;
        }

        .login-box {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            width: 100%;
            max-width: 400px;
            box-shadow: var(--shadow-xl);
            text-align: center;
        }

        .login-header {
            margin-bottom: var(--space-xl);
        }

        .login-icon {
            font-size: 3rem;
            display: block;
            margin-bottom: var(--space-md);
        }

        .login-header h2 {
            font-size: var(--font-size-xl);
            color: var(--gray-800);
        }

        .login-field {
            text-align: left;
            margin-bottom: var(--space-md);
        }

        .login-field label {
            display: block;
            font-size: var(--font-size-sm);
            font-weight: 500;
            color: var(--gray-600);
            margin-bottom: var(--space-xs);
        }

        .login-field input {
            width: 100%;
            padding: var(--space-md);
            border: 2px solid var(--gray-200);
            border-radius: var(--radius-md);
            font-size: var(--font-size-base);
            transition: all var(--transition-fast);
        }

        .login-field input:focus {
            outline: none;
            border-color: var(--primary-400);
            box-shadow: 0 0 0 3px rgba(0, 180, 161, 0.15);
        }

        .login-error {
            color: var(--danger);
            font-size: var(--font-size-sm);
            margin-bottom: var(--space-md);
            min-height: 20px;
        }

        .btn-login {
            width: 100%;
            padding: var(--space-md);
            font-size: var(--font-size-base);
        }
    </style>

    <script>
        // Password protection - check on page load
        (function() {
            const CORRECT_PASSWORD = 'tennis2024'; // Change this password
            const AUTH_KEY = 'tennis_db_auth';
            
            // Check if already authenticated
            if (sessionStorage.getItem(AUTH_KEY) === 'true') {
                document.getElementById('loginOverlay').classList.add('hidden');
                return;
            }
            
            // Handle login form
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const password = document.getElementById('password').value;
                const errorEl = document.getElementById('loginError');
                
                if (password === CORRECT_PASSWORD) {
                    sessionStorage.setItem(AUTH_KEY, 'true');
                    document.getElementById('loginOverlay').classList.add('hidden');
                } else {
                    errorEl.textContent = '‚ùå Password errata. Riprova.';
                    document.getElementById('password').value = '';
                    document.getElementById('password').focus();
                }
            });
        })();
    </script>

    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">üéæ</span>
                    <h1>Database Giocatori</h1>
                </div>
                <div class="header-actions">
                    <a href="search.html" class="btn btn-secondary">
                        üîç Cerca Disponibilit√†
                    </a>
                    <button class="btn btn-primary" id="btnNewPlayer">
                        <span class="btn-icon">+</span>
                        Nuovo Giocatore
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Sidebar Filters -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <h2>üîç Filtri</h2>
                    <button class="btn-reset" id="btnResetFilters">Reset</button>
                </div>

                <!-- Search -->
                <div class="filter-group">
                    <label class="filter-label">Cerca giocatore</label>
                    <input type="text" class="filter-input" id="searchInput" placeholder="Nome o cognome...">
                </div>

                <!-- Level Filter -->
                <div class="filter-group">
                    <label class="filter-label">Livello di gioco</label>
                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" name="level" value="principiante">
                            <span class="checkbox-custom"></span>
                            <span class="level-badge level-principiante">Principiante</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="level" value="intermedio">
                            <span class="checkbox-custom"></span>
                            <span class="level-badge level-intermedio">Intermedio</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="level" value="avanzato">
                            <span class="checkbox-custom"></span>
                            <span class="level-badge level-avanzato">Avanzato</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="level" value="agonista">
                            <span class="checkbox-custom"></span>
                            <span class="level-badge level-agonista">Agonista</span>
                        </label>
                    </div>
                </div>

                <!-- Player Search Filter -->
                <div class="filter-group">
                    <label class="filter-label">Cerca preferenze</label>
                    <input type="text" class="filter-input" id="preferenceSearch" placeholder="Nome giocatore...">
                    <span class="filter-value">Cerca nei preferiti/indesiderati</span>
                </div>

                <!-- Day Filter -->
                <div class="filter-group">
                    <label class="filter-label">Giorno disponibile</label>
                    <div class="checkbox-group days-group">
                        <label class="checkbox-item">
                            <input type="checkbox" name="day" value="lunedi">
                            <span class="checkbox-custom"></span>
                            <span>Luned√¨</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="day" value="martedi">
                            <span class="checkbox-custom"></span>
                            <span>Marted√¨</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="day" value="mercoledi">
                            <span class="checkbox-custom"></span>
                            <span>Mercoled√¨</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="day" value="giovedi">
                            <span class="checkbox-custom"></span>
                            <span>Gioved√¨</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="day" value="venerdi">
                            <span class="checkbox-custom"></span>
                            <span>Venerd√¨</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="day" value="sabato">
                            <span class="checkbox-custom"></span>
                            <span>Sabato</span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="day" value="domenica">
                            <span class="checkbox-custom"></span>
                            <span>Domenica</span>
                        </label>
                    </div>
                </div>

                <!-- Time Range Filter -->
                <div class="filter-group">
                    <label class="filter-label">Fascia oraria</label>
                    <div class="time-range-filter">
                        <input type="time" id="filterTimeStart" class="filter-input time-input">
                        <span class="time-separator">‚Äî</span>
                        <input type="time" id="filterTimeEnd" class="filter-input time-input">
                    </div>
                </div>
            </aside>

            <!-- Mobile Filter Toggle -->
            <button class="btn-filter-toggle" id="btnToggleFilters">
                üîç Filtri
            </button>

            <!-- Players Grid -->
            <section class="players-section">
                <div class="players-header">
                    <h2>Giocatori <span class="count" id="playerCount">(0)</span></h2>
                    <div class="view-toggle">
                        <button class="btn-view active" id="btnGridView" title="Vista griglia">‚ñ¶</button>
                        <button class="btn-view" id="btnListView" title="Vista lista">‚ò∞</button>
                    </div>
                </div>
                <div class="players-grid" id="playersGrid">
                    <!-- Player cards will be inserted here -->
                </div>
                <div class="empty-state" id="emptyState">
                    <span class="empty-icon">üéæ</span>
                    <h3>Nessun giocatore trovato</h3>
                    <p>Aggiungi il primo giocatore o modifica i filtri di ricerca</p>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal: Add/Edit Player -->
    <div class="modal-overlay" id="playerModal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="modalTitle">Nuovo Giocatore</h2>
                <button class="btn-close" id="btnCloseModal">√ó</button>
            </div>
            <form class="modal-body" id="playerForm">
                <input type="hidden" id="playerId">

                <div class="form-row">
                    <div class="form-group">
                        <label for="cognome">Cognome *</label>
                        <input type="text" id="cognome" required placeholder="Es. Rossi">
                    </div>
                    <div class="form-group">
                        <label for="nome">Nome *</label>
                        <input type="text" id="nome" required placeholder="Es. Mario">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="telefono">Telefono *</label>
                        <input type="tel" id="telefono" required placeholder="Es. 333-1234567">
                    </div>
                    <div class="form-group">
                        <label for="livello">Livello di gioco *</label>
                        <select id="livello" required>
                            <option value="">Seleziona...</option>
                            <option value="principiante">Principiante</option>
                            <option value="intermedio">Intermedio</option>
                            <option value="avanzato">Avanzato</option>
                            <option value="agonista">Agonista</option>
                        </select>
                    </div>
                </div>

                <!-- Player Preferences Section -->
                <div class="form-group preferences-section">
                    <label>Preferenze giocatori</label>

                    <div class="player-selector">
                        <select id="playerSelect" class="player-dropdown">
                            <option value="">Seleziona giocatore...</option>
                            <!-- Options populated dynamically -->
                        </select>
                        <div class="selector-buttons">
                            <button type="button" class="btn btn-preferred" id="btnAddPreferred"
                                title="Aggiungi ai preferiti">
                                üëç Preferito
                            </button>
                            <button type="button" class="btn btn-unwanted" id="btnAddUnwanted"
                                title="Aggiungi agli indesiderati">
                                üëé Indesiderato
                            </button>
                        </div>
                    </div>

                    <div class="preferences-lists">
                        <div class="preference-list preferred-list">
                            <h4>üëç Preferiti</h4>
                            <ul id="preferredList">
                                <!-- Preferred players will be added here -->
                            </ul>
                        </div>
                        <div class="preference-list unwanted-list">
                            <h4>üëé Indesiderati</h4>
                            <ul id="unwantedList">
                                <!-- Unwanted players will be added here -->
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="form-group availability-section">
                    <label>Disponibilit√† oraria</label>
                    <div class="availability-list" id="availabilityList">
                        <!-- Availability slots will be added here -->
                    </div>
                    <button type="button" class="btn btn-secondary btn-add-availability" id="btnAddAvailability">
                        + Aggiungi disponibilit√†
                    </button>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="btnCancel">Annulla</button>
                    <button type="submit" class="btn btn-primary" id="btnSave">Salva</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: Delete Confirmation -->
    <div class="modal-overlay" id="deleteModal">
        <div class="modal modal-small">
            <div class="modal-header">
                <h2>Conferma eliminazione</h2>
                <button class="btn-close" id="btnCloseDeleteModal">√ó</button>
            </div>
            <div class="modal-body">
                <p>Sei sicuro di voler eliminare <strong id="deletePlayerName"></strong>?</p>
                <p class="text-muted">Questa azione non pu√≤ essere annullata.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="btnCancelDelete">Annulla</button>
                <button type="button" class="btn btn-danger" id="btnConfirmDelete">Elimina</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span class="toast-icon"></span>
        <span class="toast-message"></span>
    </div>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <!-- Firebase Configuration -->
    <script src="firebase-config.js"></script>

    <script src="app.js"></script>
</body>

</html>